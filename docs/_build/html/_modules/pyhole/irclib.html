

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyhole.irclib &mdash; pyhole v0.5.4-2f4ef documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.4-2f4ef',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="pyhole v0.5.4-2f4ef documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">pyhole v0.5.4-2f4ef documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyhole.irclib</h1><div class="highlight"><pre>
<span class="c"># Copyright (C) 1999--2002  Joel Rosdahl</span>
<span class="c">#</span>
<span class="c"># This library is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU Lesser General Public</span>
<span class="c"># License as published by the Free Software Foundation; either</span>
<span class="c"># version 2.1 of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># This library is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="c"># Lesser General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU Lesser General Public</span>
<span class="c"># License along with this library; if not, write to the Free Software</span>
<span class="c"># Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307  USA</span>
<span class="c">#</span>
<span class="c"># keltus &lt;keltus@users.sourceforge.net&gt;</span>
<span class="c">#</span>
<span class="c"># $Id: irclib.py,v 1.47 2008/09/25 22:00:59 keltus Exp $</span>

<span class="sd">&quot;&quot;&quot;irclib -- Internet Relay Chat (IRC) protocol client library.</span>

<span class="sd">This library is intended to encapsulate the IRC protocol at a quite</span>
<span class="sd">low level.  It provides an event-driven IRC client framework.  It has</span>
<span class="sd">a fairly thorough support for the basic IRC protocol, CTCP, DCC chat,</span>
<span class="sd">but DCC file transfers is not yet supported.</span>

<span class="sd">In order to understand how to make an IRC client, I&#39;m afraid you more</span>
<span class="sd">or less must understand the IRC specifications.  They are available</span>
<span class="sd">here: [IRC specifications].</span>

<span class="sd">The main features of the IRC client framework are:</span>

<span class="sd">  * Abstraction of the IRC protocol.</span>
<span class="sd">  * Handles multiple simultaneous IRC server connections.</span>
<span class="sd">  * Handles server PONGing transparently.</span>
<span class="sd">  * Messages to the IRC server are done by calling methods on an IRC</span>
<span class="sd">    connection object.</span>
<span class="sd">  * Messages from an IRC server triggers events, which can be caught</span>
<span class="sd">    by event handlers.</span>
<span class="sd">  * Reading from and writing to IRC server sockets are normally done</span>
<span class="sd">    by an internal select() loop, but the select()ing may be done by</span>
<span class="sd">    an external main loop.</span>
<span class="sd">  * Functions can be registered to execute at specified times by the</span>
<span class="sd">    event-loop.</span>
<span class="sd">  * Decodes CTCP tagging correctly (hopefully); I haven&#39;t seen any</span>
<span class="sd">    other IRC client implementation that handles the CTCP</span>
<span class="sd">    specification subtilties.</span>
<span class="sd">  * A kind of simple, single-server, object-oriented IRC client class</span>
<span class="sd">    that dispatches events to instance methods is included.</span>

<span class="sd">Current limitations:</span>

<span class="sd">  * The IRC protocol shines through the abstraction a bit too much.</span>
<span class="sd">  * Data is not written asynchronously to the server, i.e. the write()</span>
<span class="sd">    may block if the TCP buffers are stuffed.</span>
<span class="sd">  * There are no support for DCC file transfers.</span>
<span class="sd">  * The author haven&#39;t even read RFC 2810, 2811, 2812 and 2813.</span>
<span class="sd">  * Like most projects, documentation is lacking...</span>

<span class="sd">.. [IRC specifications] http://www.irchelp.org/irchelp/rfc/</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">bisect</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">select</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">types</span>

<span class="n">VERSION</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c"># TODO</span>
<span class="c"># ----</span>
<span class="c"># (maybe) thread safety</span>
<span class="c"># (maybe) color parser convenience functions</span>
<span class="c"># documentation (including all event types)</span>
<span class="c"># (maybe) add awareness of different types of ircds</span>
<span class="c"># send data asynchronously to the server (and DCC connections)</span>
<span class="c"># (maybe) automatically close unused, passive DCC connections after a while</span>

<span class="c"># NOTES</span>
<span class="c"># -----</span>
<span class="c"># connection.quit() only sends QUIT to the server.</span>
<span class="c"># ERROR from the server triggers the error event and the disconnect event.</span>
<span class="c"># dropping of the connection triggers the disconnect event.</span>


<div class="viewcode-block" id="IRCError"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRCError">[docs]</a><span class="k">class</span> <span class="nc">IRCError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents an IRC exception.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="IRC"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC">[docs]</a><span class="k">class</span> <span class="nc">IRC</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class that handles one or several IRC server connections.</span>

<span class="sd">    When an IRC object has been instantiated, it can be used to create</span>
<span class="sd">    Connection objects that represent the IRC connections.  The</span>
<span class="sd">    responsibility of the IRC object is to provide an event-driven</span>
<span class="sd">    framework for the connections and to keep the connections alive.</span>
<span class="sd">    It runs a select loop to poll each connection&#39;s TCP socket and</span>
<span class="sd">    hands over the sockets with incoming data for processing by the</span>
<span class="sd">    corresponding connection.</span>

<span class="sd">    The methods of most interest for an IRC client writer are server,</span>
<span class="sd">    add_global_handler, remove_global_handler, execute_at,</span>
<span class="sd">    execute_delayed, process_once and process_forever.</span>

<span class="sd">    Here is an example:</span>

<span class="sd">        irc = irclib.IRC()</span>
<span class="sd">        server = irc.server()</span>
<span class="sd">        server.connect(\&quot;irc.some.where\&quot;, 6667, \&quot;my_nickname\&quot;)</span>
<span class="sd">        server.privmsg(\&quot;a_nickname\&quot;, \&quot;Hi there!\&quot;)</span>
<span class="sd">        irc.process_forever()</span>

<span class="sd">    This will connect to the IRC server irc.some.where on port 6667</span>
<span class="sd">    using the nickname my_nickname and send the message \&quot;Hi there!\&quot;</span>
<span class="sd">    to the nickname a_nickname.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_to_add_socket</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">fn_to_remove_socket</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">fn_to_add_timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for IRC objects.</span>

<span class="sd">        Optional arguments are fn_to_add_socket, fn_to_remove_socket</span>
<span class="sd">        and fn_to_add_timeout.  The first two specify functions that</span>
<span class="sd">        will be called with a socket object as argument when the IRC</span>
<span class="sd">        object wants to be notified (or stop being notified) of data</span>
<span class="sd">        coming on a new socket.  When new data arrives, the method</span>
<span class="sd">        process_data should be called.  Similarly, fn_to_add_timeout</span>
<span class="sd">        is called with a number of seconds (a floating point number)</span>
<span class="sd">        as first argument when the IRC object wants to receive a</span>
<span class="sd">        notification (by calling the process_timeout method).  So, if</span>
<span class="sd">        e.g. the argument is 42.17, the object wants the</span>
<span class="sd">        process_timeout method to be called after 42 seconds and 170</span>
<span class="sd">        milliseconds.</span>

<span class="sd">        The three arguments mainly exist to be able to use an external</span>
<span class="sd">        main loop (for example Tkinter&#39;s or PyGTK&#39;s main app loop)</span>
<span class="sd">        instead of calling the process_forever method.</span>

<span class="sd">        An alternative is to just call ServerConnection.process_once()</span>
<span class="sd">        once in a while.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fn_to_add_socket</span> <span class="ow">and</span> <span class="n">fn_to_remove_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_add_socket</span> <span class="o">=</span> <span class="n">fn_to_add_socket</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_remove_socket</span> <span class="o">=</span> <span class="n">fn_to_remove_socket</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_add_socket</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_remove_socket</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_add_timeout</span> <span class="o">=</span> <span class="n">fn_to_add_timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># list of tuples in the format (time, function, arguments)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_global_handler</span><span class="p">(</span><span class="s">&quot;ping&quot;</span><span class="p">,</span> <span class="n">_ping_ponger</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">)</span>

<div class="viewcode-block" id="IRC.server"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.server">[docs]</a>    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates and returns a ServerConnection object.&quot;&quot;&quot;</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">ServerConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span>
</div>
<div class="viewcode-block" id="IRC.process_data"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.process_data">[docs]</a>    <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sockets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when there is more data to read on connection sockets.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            sockets -- A list of socket objects.</span>

<span class="sd">        See documentation for IRC.__init__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sockets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">_get_socket</span><span class="p">():</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">process_data</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="IRC.process_timeout"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.process_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">process_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when a timeout notification is due.</span>

<span class="sd">        See documentation for IRC.__init__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">](</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
</div>
<div class="viewcode-block" id="IRC.process_once"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.process_once">[docs]</a>    <span class="k">def</span> <span class="nf">process_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process data from connections once.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            timeout -- How long the select() call should wait if no</span>
<span class="sd">                       data is available.</span>

<span class="sd">        This method should be called periodically to check and process</span>
<span class="sd">        incoming data, if there are any.  If that seems boring, look</span>
<span class="sd">        at the process_forever method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sockets</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_get_socket</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">)</span>
        <span class="n">sockets</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">sockets</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sockets</span><span class="p">:</span>
            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">sockets</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_timeout</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="IRC.process_forever"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.process_forever">[docs]</a>    <span class="k">def</span> <span class="nf">process_forever</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run an infinite loop, processing data from connections.</span>

<span class="sd">        This method repeatedly calls process_once.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            timeout -- Parameter to pass to process_once.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_once</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRC.disconnect_all"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.disconnect_all">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disconnects all connections.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRC.add_global_handler"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.add_global_handler">[docs]</a>    <span class="k">def</span> <span class="nf">add_global_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a global handler function for a specific event type.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            event -- Event type (a string).  Check the values of the</span>
<span class="sd">            numeric_events dictionary in irclib.py for possible event</span>
<span class="sd">            types.</span>

<span class="sd">            handler -- Callback function.</span>

<span class="sd">            priority -- A number (the lower number, the higher priority).</span>

<span class="sd">        The handler function is called whenever the specified event is</span>
<span class="sd">        triggered in any of the connections.  See documentation for</span>
<span class="sd">        the Event class.</span>

<span class="sd">        The handler functions are called in priority order (lowest</span>
<span class="sd">        number is highest priority).  If a handler function returns</span>
<span class="sd">        \&quot;NO MORE\&quot;, no more handlers will be called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bisect</span><span class="o">.</span><span class="n">insort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event</span><span class="p">],</span> <span class="p">((</span><span class="n">priority</span><span class="p">,</span> <span class="n">handler</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="IRC.remove_global_handler"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.remove_global_handler">[docs]</a>    <span class="k">def</span> <span class="nf">remove_global_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">handler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes a global handler function.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            event -- Event type (a string).</span>

<span class="sd">            handler -- Callback function.</span>

<span class="sd">        Returns 1 on success, otherwise 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">handler</span> <span class="o">==</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="IRC.execute_at"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.execute_at">[docs]</a>    <span class="k">def</span> <span class="nf">execute_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;Execute a function at a specified time.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            at -- Execute at this time (standard \&quot;time_t\&quot; time).</span>

<span class="sd">            function -- Function to call.</span>

<span class="sd">            arguments -- Arguments to give the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_delayed</span><span class="p">(</span><span class="n">at</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRC.execute_delayed"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.execute_delayed">[docs]</a>    <span class="k">def</span> <span class="nf">execute_delayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;Execute a function after a specified time.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            delay -- How many seconds to wait.</span>

<span class="sd">            function -- Function to call.</span>

<span class="sd">            arguments -- Arguments to give the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bisect</span><span class="o">.</span><span class="n">insort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_commands</span><span class="p">,</span>
            <span class="p">(</span><span class="n">delay</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_add_timeout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_add_timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRC.dcc"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.IRC.dcc">[docs]</a>    <span class="k">def</span> <span class="nf">dcc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dcctype</span><span class="o">=</span><span class="s">&quot;chat&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates and returns a DCCConnection object.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            dcctype -- &quot;chat&quot; for DCC CHAT connections or &quot;raw&quot; for</span>
<span class="sd">                       DCC SEND (or other DCC types). If &quot;chat&quot;,</span>
<span class="sd">                       incoming data will be split in newline-separated</span>
<span class="sd">                       chunks. If &quot;raw&quot;, incoming data is not touched.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">DCCConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dcctype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span>
</div>
    <span class="k">def</span> <span class="nf">_handle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span>
        <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;all_events&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> <span class="n">h</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">eventtype</span><span class="p">(),</span> <span class="p">[]):</span>
            <span class="k">if</span> <span class="n">handler</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">connection</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;NO MORE&quot;</span><span class="p">:</span>
                <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_remove_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_remove_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fn_to_remove_socket</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">_get_socket</span><span class="p">())</span>
</div>
<span class="n">_rfc_1459_command_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="s">&quot;^(:(?P&lt;prefix&gt;[^ ]+) +)?(?P&lt;command&gt;[^ ]+)( *(?P&lt;argument&gt; .+))?&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="Connection"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Connection">[docs]</a><span class="k">class</span> <span class="nc">Connection</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for IRC connections.</span>

<span class="sd">    Must be overridden.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irclibobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span> <span class="o">=</span> <span class="n">irclibobj</span>

    <span class="k">def</span> <span class="nf">_get_socket</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">IRCError</span><span class="p">(</span><span class="s">&quot;Not overridden&quot;</span><span class="p">)</span>

    <span class="c">##############################</span>
    <span class="c">### Convenience wrappers.</span>

<div class="viewcode-block" id="Connection.execute_at"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Connection.execute_at">[docs]</a>    <span class="k">def</span> <span class="nf">execute_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">execute_at</span><span class="p">(</span><span class="n">at</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Connection.execute_delayed"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Connection.execute_delayed">[docs]</a>    <span class="k">def</span> <span class="nf">execute_delayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">execute_delayed</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ServerConnectionError"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnectionError">[docs]</a><span class="k">class</span> <span class="nc">ServerConnectionError</span><span class="p">(</span><span class="n">IRCError</span><span class="p">):</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="ServerNotConnectedError"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerNotConnectedError">[docs]</a><span class="k">class</span> <span class="nc">ServerNotConnectedError</span><span class="p">(</span><span class="n">ServerConnectionError</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="c"># Huh!?  Crrrrazy EFNet doesn&#39;t follow the RFC: their ircd seems to</span>
<span class="c"># use \n as message separator!  :P</span></div>
<span class="n">_linesep_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="ServerConnection"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection">[docs]</a><span class="k">class</span> <span class="nc">ServerConnection</span><span class="p">(</span><span class="n">Connection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents an IRC server connection.</span>

<span class="sd">    ServerConnection objects are instantiated by calling the server</span>
<span class="sd">    method on an IRC object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irclibobj</span><span class="p">):</span>
        <span class="n">Connection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irclibobj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># Not connected yet.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="ServerConnection.connect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">ircname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">localaddress</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">localport</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ipv6</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect/reconnect to a server.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            server -- Server name.</span>

<span class="sd">            port -- Port number.</span>

<span class="sd">            nickname -- The nickname.</span>

<span class="sd">            password -- Password (if any).</span>

<span class="sd">            username -- The username.</span>

<span class="sd">            ircname -- The IRC name (&quot;realname&quot;).</span>

<span class="sd">            localaddress -- Bind the connection to a specific local IP address.</span>

<span class="sd">            localport -- Bind the connection to a specific local port.</span>

<span class="sd">            ssl -- Enable support for ssl.</span>

<span class="sd">            ipv6 -- Enable support for ipv6.</span>

<span class="sd">        This function can be called to reconnect a closed connection.</span>

<span class="sd">        Returns the ServerConnection object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Changing servers&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_server_name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_nickname</span> <span class="o">=</span> <span class="n">nickname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">nickname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span> <span class="ow">or</span> <span class="n">nickname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ircname</span> <span class="o">=</span> <span class="n">ircname</span> <span class="ow">or</span> <span class="n">nickname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localaddress</span> <span class="o">=</span> <span class="n">localaddress</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localport</span> <span class="o">=</span> <span class="n">localport</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localhost</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ipv6</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET6</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">localaddress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">localport</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ssl</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">ssl</span>
                    <span class="n">ssl_wrap</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">wrap_socket</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="n">ssl_wrap</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">ssl</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="n">ssl_wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">raise</span> <span class="n">ServerConnectionError</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t connect to socket: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">fn_to_add_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">fn_to_add_socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="p">)</span>

        <span class="c"># Log on...</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pass_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nickname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ircname</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="ServerConnection.close"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the connection.</span>

<span class="sd">        This method closes the connection permanently; after it has</span>
<span class="sd">        been called, the object is unusable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Closing object&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_remove_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_get_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span>

<div class="viewcode-block" id="ServerConnection.get_server_name"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.get_server_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_server_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the (real) server name.</span>

<span class="sd">        This method returns the (real) server name, or, more</span>
<span class="sd">        specifically, what the server calls itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_server_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_server_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span>
</div>
<div class="viewcode-block" id="ServerConnection.get_nickname"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.get_nickname">[docs]</a>    <span class="k">def</span> <span class="nf">get_nickname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the (real) nick name.</span>

<span class="sd">        This method returns the (real) nickname.  The library keeps</span>
<span class="sd">        track of nick changes, so it might not be the nick name that</span>
<span class="sd">        was passed to the connect() method.  &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_nickname</span>
</div>
<div class="viewcode-block" id="ServerConnection.process_data"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.process_data">[docs]</a>    <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="p">:</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="c"># The server hung up.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_data</span><span class="p">:</span>
            <span class="c"># Read nothing: connection must be down.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="n">_linesep_regexp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">+</span> <span class="n">new_data</span><span class="p">)</span>

        <span class="c"># Save the last, unfinished line.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;FROM SERVER:&quot;</span><span class="p">,</span> <span class="n">line</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">prefix</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="s">&quot;all_raw_messages&quot;</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">get_server_name</span><span class="p">(),</span>
                                     <span class="bp">None</span><span class="p">,</span>
                                     <span class="p">[</span><span class="n">line</span><span class="p">]))</span>

            <span class="n">m</span> <span class="o">=</span> <span class="n">_rfc_1459_command_regexp</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;prefix&quot;</span><span class="p">):</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;prefix&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_server_name</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">real_server_name</span> <span class="o">=</span> <span class="n">prefix</span>

            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;command&quot;</span><span class="p">):</span>
                <span class="n">command</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;command&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;argument&quot;</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&quot;argument&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; :&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">arguments</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c"># Translate numerics into more readable strings.</span>
            <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">numeric_events</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="n">numeric_events</span><span class="p">[</span><span class="n">command</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;nick&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nm_to_n</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_nickname</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">real_nickname</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;welcome&quot;</span><span class="p">:</span>
                <span class="c"># Record the nickname in case the client changed nick</span>
                <span class="c"># in a nicknameinuse callback.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_nickname</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;privmsg&quot;</span><span class="p">,</span> <span class="s">&quot;notice&quot;</span><span class="p">]:</span>
                <span class="n">target</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">messages</span> <span class="o">=</span> <span class="n">_ctcp_dequote</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;privmsg&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">is_channel</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;pubmsg&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">is_channel</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;pubnotice&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;privnotice&quot;</span>

                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">is</span> <span class="n">types</span><span class="o">.</span><span class="n">TupleType</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;privmsg&quot;</span><span class="p">,</span> <span class="s">&quot;pubmsg&quot;</span><span class="p">]:</span>
                            <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;ctcp&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;ctcpreply&quot;</span>

                        <span class="n">m</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                            <span class="k">print</span> <span class="s">&quot;command: </span><span class="si">%s</span><span class="s">, source: </span><span class="si">%s</span><span class="s">, target: </span><span class="si">%s</span><span class="s">, &quot;</span> \
                                <span class="s">&quot;arguments: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;ctcp&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;ACTION&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span>
                                <span class="n">Event</span><span class="p">(</span><span class="s">&quot;action&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                            <span class="k">print</span> <span class="s">&quot;command: </span><span class="si">%s</span><span class="s">, source: </span><span class="si">%s</span><span class="s">, target: </span><span class="si">%s</span><span class="s">, &quot;</span> \
                                <span class="s">&quot;arguments: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="n">m</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="n">m</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">=</span> <span class="bp">None</span>

                <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;quit&quot;</span><span class="p">:</span>
                    <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;ping&quot;</span><span class="p">:</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">arguments</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

                <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&quot;mode&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_channel</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;umode&quot;</span>

                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">&quot;command: </span><span class="si">%s</span><span class="s">, source: </span><span class="si">%s</span><span class="s">, target: </span><span class="si">%s</span><span class="s">, &quot;</span> \
                        <span class="s">&quot;arguments: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_handle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">eventtype</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">eventtype</span><span class="p">()]:</span>
                <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

<div class="viewcode-block" id="ServerConnection.is_connected"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.is_connected">[docs]</a>    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return connection status.</span>

<span class="sd">        Returns true if connected, otherwise false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span>
</div>
<div class="viewcode-block" id="ServerConnection.add_global_handler"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.add_global_handler">[docs]</a>    <span class="k">def</span> <span class="nf">add_global_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add global handler.</span>

<span class="sd">        See documentation for IRC.add_global_handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">add_global_handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.remove_global_handler"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.remove_global_handler">[docs]</a>    <span class="k">def</span> <span class="nf">remove_global_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove global handler.</span>

<span class="sd">        See documentation for IRC.remove_global_handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">remove_global_handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.action"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.action">[docs]</a>    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a CTCP ACTION command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctcp</span><span class="p">(</span><span class="s">&quot;ACTION&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.admin"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.admin">[docs]</a>    <span class="k">def</span> <span class="nf">admin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an ADMIN command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;ADMIN&quot;</span><span class="p">,</span> <span class="n">server</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ServerConnection.ctcp"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.ctcp">[docs]</a>    <span class="k">def</span> <span class="nf">ctcp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctcptype</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a CTCP command.&quot;&quot;&quot;</span>
        <span class="n">ctcptype</span> <span class="o">=</span> <span class="n">ctcptype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">privmsg</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\001</span><span class="si">%s%s</span><span class="se">\001</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">ctcptype</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">parameter</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.ctcp_reply"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.ctcp_reply">[docs]</a>    <span class="k">def</span> <span class="nf">ctcp_reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a CTCP REPLY command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notice</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\001</span><span class="si">%s</span><span class="se">\001</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">parameter</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.disconnect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hang up the connection.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            message -- Quit message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="s">&quot;disconnect&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">message</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="ServerConnection.globops"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.globops">[docs]</a>    <span class="k">def</span> <span class="nf">globops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a GLOBOPS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;GLOBOPS :&quot;</span> <span class="o">+</span> <span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.info"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an INFO command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;INFO&quot;</span><span class="p">,</span> <span class="n">server</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ServerConnection.invite"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.invite">[docs]</a>    <span class="k">def</span> <span class="nf">invite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an INVITE command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;INVITE&quot;</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">channel</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="ServerConnection.ison"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.ison">[docs]</a>    <span class="k">def</span> <span class="nf">ison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nicks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an ISON command.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            nicks -- List of nicks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;ISON &quot;</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nicks</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.join"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a JOIN command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;JOIN </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">))))</span>
</div>
<div class="viewcode-block" id="ServerConnection.kick"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.kick">[docs]</a>    <span class="k">def</span> <span class="nf">kick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a KICK command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;KICK </span><span class="si">%s</span><span class="s"> </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">channel</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="p">(</span><span class="n">comment</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; :&quot;</span> <span class="o">+</span> <span class="n">comment</span><span class="p">))))</span>
</div>
<div class="viewcode-block" id="ServerConnection.links"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.links">[docs]</a>    <span class="k">def</span> <span class="nf">links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remote_server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">server_mask</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a LINKS command.&quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;LINKS&quot;</span>
        <span class="k">if</span> <span class="n">remote_server</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">remote_server</span>
        <span class="k">if</span> <span class="n">server_mask</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server_mask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.list"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a LIST command.&quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;LIST&quot;</span>
        <span class="k">if</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.lusers"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.lusers">[docs]</a>    <span class="k">def</span> <span class="nf">lusers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a LUSERS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;LUSERS&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.mode"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.mode">[docs]</a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a MODE command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;MODE </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.motd"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.motd">[docs]</a>    <span class="k">def</span> <span class="nf">motd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an MOTD command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;MOTD&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.names"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.names">[docs]</a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a NAMES command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;NAMES&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">channels</span> <span class="ow">and</span>
            <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">channels</span><span class="p">))</span> <span class="ow">or</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.nick"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.nick">[docs]</a>    <span class="k">def</span> <span class="nf">nick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newnick</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a NICK command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;NICK &quot;</span> <span class="o">+</span> <span class="n">newnick</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.notice"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.notice">[docs]</a>    <span class="k">def</span> <span class="nf">notice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a NOTICE command.&quot;&quot;&quot;</span>
        <span class="c"># Should limit len(text) here!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;NOTICE </span><span class="si">%s</span><span class="s"> :</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.oper"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.oper">[docs]</a>    <span class="k">def</span> <span class="nf">oper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an OPER command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;OPER </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.part"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.part">[docs]</a>    <span class="k">def</span> <span class="nf">part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PART command.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="n">types</span><span class="o">.</span><span class="n">StringType</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PART &quot;</span> <span class="o">+</span> <span class="n">channels</span> <span class="o">+</span> <span class="p">(</span><span class="n">message</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PART &quot;</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">+</span>
                <span class="p">(</span><span class="n">message</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.pass_"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.pass_">[docs]</a>    <span class="k">def</span> <span class="nf">pass_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PASS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PASS &quot;</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.ping"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.ping">[docs]</a>    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">target2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PING command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PING </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">target2</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">target2</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.pong"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.pong">[docs]</a>    <span class="k">def</span> <span class="nf">pong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">target2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PONG command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PONG </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">target2</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">target2</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.privmsg"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.privmsg">[docs]</a>    <span class="k">def</span> <span class="nf">privmsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PRIVMSG command.&quot;&quot;&quot;</span>
        <span class="c"># Should limit len(text) here!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PRIVMSG </span><span class="si">%s</span><span class="s"> :</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.privmsg_many"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.privmsg_many">[docs]</a>    <span class="k">def</span> <span class="nf">privmsg_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a PRIVMSG command to multiple targets.&quot;&quot;&quot;</span>
        <span class="c"># Should limit len(text) here!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;PRIVMSG </span><span class="si">%s</span><span class="s"> :</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="n">text</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.quit"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.quit">[docs]</a>    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a QUIT command.&quot;&quot;&quot;</span>
        <span class="c"># Note that many IRC servers don&#39;t use your QUIT message</span>
        <span class="c"># unless you&#39;ve been connected for at least 5 minutes!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;QUIT&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">message</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; :&quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.send_raw"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.send_raw">[docs]</a>    <span class="k">def</span> <span class="nf">send_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send raw string to the server.</span>

<span class="sd">        The string will be padded with appropriate CR LF.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ServerNotConnectedError</span><span class="p">(</span><span class="s">&quot;Not connected.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;TO SERVER:&quot;</span><span class="p">,</span> <span class="n">string</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="c"># Ouch!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer.&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.squit"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.squit">[docs]</a>    <span class="k">def</span> <span class="nf">squit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an SQUIT command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;SQUIT </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; :&quot;</span> <span class="o">+</span> <span class="n">comment</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.stats"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">statstype</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a STATS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;STATS </span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">statstype</span><span class="p">,</span> <span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.time"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.time">[docs]</a>    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a TIME command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;TIME&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.topic"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.topic">[docs]</a>    <span class="k">def</span> <span class="nf">topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">new_topic</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a TOPIC command.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_topic</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;TOPIC &quot;</span> <span class="o">+</span> <span class="n">channel</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;TOPIC </span><span class="si">%s</span><span class="s"> :</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">new_topic</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.trace"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.trace">[docs]</a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a TRACE command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;TRACE&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">target</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">target</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.user"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.user">[docs]</a>    <span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">realname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a USER command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;USER </span><span class="si">%s</span><span class="s"> 0 * :</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">realname</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.userhost"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.userhost">[docs]</a>    <span class="k">def</span> <span class="nf">userhost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nicks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a USERHOST command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;USERHOST &quot;</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nicks</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.users"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.users">[docs]</a>    <span class="k">def</span> <span class="nf">users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a USERS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;USERS&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.version"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.version">[docs]</a>    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a VERSION command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;VERSION&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.wallops"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.wallops">[docs]</a>    <span class="k">def</span> <span class="nf">wallops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a WALLOPS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;WALLOPS :&quot;</span> <span class="o">+</span> <span class="n">text</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ServerConnection.who"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.who">[docs]</a>    <span class="k">def</span> <span class="nf">who</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a WHO command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;WHO</span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">target</span><span class="p">),</span> <span class="n">op</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; o&quot;</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="ServerConnection.whois"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.whois">[docs]</a>    <span class="k">def</span> <span class="nf">whois</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a WHOIS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;WHOIS &quot;</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">targets</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ServerConnection.whowas"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ServerConnection.whowas">[docs]</a>    <span class="k">def</span> <span class="nf">whowas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a WHOWAS command.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_raw</span><span class="p">(</span><span class="s">&quot;WHOWAS </span><span class="si">%s%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nick</span><span class="p">,</span>
                                         <span class="nb">max</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="nb">max</span><span class="p">),</span>
                                         <span class="n">server</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">server</span><span class="p">)))</span>

</div></div>
<div class="viewcode-block" id="DCCConnectionError"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnectionError">[docs]</a><span class="k">class</span> <span class="nc">DCCConnectionError</span><span class="p">(</span><span class="n">IRCError</span><span class="p">):</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="DCCConnection"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection">[docs]</a><span class="k">class</span> <span class="nc">DCCConnection</span><span class="p">(</span><span class="n">Connection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents a DCC connection.</span>

<span class="sd">    DCCConnection objects are instantiated by calling the dcc</span>
<span class="sd">    method on an IRC object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irclibobj</span><span class="p">,</span> <span class="n">dcctype</span><span class="p">):</span>
        <span class="n">Connection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irclibobj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passive</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcctype</span> <span class="o">=</span> <span class="n">dcctype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peerport</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="DCCConnection.connect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect/reconnect to a DCC peer.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            address -- Host/IP address of the peer.</span>

<span class="sd">            port -- The port number to connect to.</span>

<span class="sd">        Returns the DCCConnection object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peerport</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passive</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peerport</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DCCConnectionError</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t connect to socket: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">fn_to_add_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">fn_to_add_socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="DCCConnection.listen"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection.listen">[docs]</a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait for a connection/reconnection from a DCC peer.</span>

<span class="sd">        Returns the DCCConnection object.</span>

<span class="sd">        The local IP address and port are available as</span>
<span class="sd">        self.localaddress and self.localport.  After connection from a</span>
<span class="sd">        peer, the peer address and port are available as</span>
<span class="sd">        self.peeraddress and self.peerport.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passive</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()),</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">localaddress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">localport</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">getsockname</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DCCConnectionError</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t bind socket: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="DCCConnection.disconnect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hang up the connection and close the object.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            message -- Quit message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">Event</span><span class="p">(</span><span class="s">&quot;dcc_disconnect&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">message</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_remove_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DCCConnection.process_data"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection.process_data">[docs]</a>    <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">passive</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="n">conn</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peerport</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">conn</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;DCC connection from </span><span class="si">%s</span><span class="s">:</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peerport</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">Event</span><span class="p">(</span><span class="s">&quot;dcc_connect&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="c"># The server hung up.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_data</span><span class="p">:</span>
            <span class="c"># Read nothing: connection must be down.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcctype</span> <span class="o">==</span> <span class="s">&quot;chat&quot;</span><span class="p">:</span>
            <span class="c"># The specification says lines are terminated with LF, but</span>
            <span class="c"># it seems safer to handle CR LF terminations too.</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="n">_linesep_regexp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">+</span> <span class="n">new_data</span><span class="p">)</span>

            <span class="c"># Save the last, unfinished line.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span> <span class="o">=</span> <span class="n">chunks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span><span class="p">:</span>
                <span class="c"># Bad peer! Naughty peer!</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="n">chunks</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_data</span><span class="p">]</span>

        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;dccmsg&quot;</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peeraddress</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;FROM PEER:&quot;</span><span class="p">,</span> <span class="n">chunk</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;command: </span><span class="si">%s</span><span class="s">, source: </span><span class="si">%s</span><span class="s">, target: </span><span class="si">%s</span><span class="s">, arguments: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irclibobj</span><span class="o">.</span><span class="n">_handle_event</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">Event</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_get_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span>

<div class="viewcode-block" id="DCCConnection.privmsg"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.DCCConnection.privmsg">[docs]</a>    <span class="k">def</span> <span class="nf">privmsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send data to DCC peer.</span>

<span class="sd">        The string will be padded with appropriate LF if it&#39;s a DCC</span>
<span class="sd">        CHAT session.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcctype</span> <span class="o">==</span> <span class="s">&quot;chat&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;TO PEER: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">string</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
            <span class="c"># Ouch!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="s">&quot;Connection reset by peer.&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="SimpleIRCClient"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.SimpleIRCClient">[docs]</a><span class="k">class</span> <span class="nc">SimpleIRCClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A simple single-server IRC client class.</span>

<span class="sd">    This is an example of an object-oriented wrapper of the IRC</span>
<span class="sd">    framework.  A real IRC client can be made by subclassing this</span>
<span class="sd">    class and adding appropriate methods.</span>

<span class="sd">    The method on_join will be called when a &quot;join&quot; event is created</span>
<span class="sd">    (which is done when the server sends a JOIN messsage/command),</span>
<span class="sd">    on_privmsg will be called for &quot;privmsg&quot; events, and so on.  The</span>
<span class="sd">    handler methods get two arguments: the connection object (same as</span>
<span class="sd">    self.connection) and the event object.</span>

<span class="sd">    Instance attributes that can be used by sub classes:</span>

<span class="sd">        ircobj -- The IRC instance.</span>

<span class="sd">        connection -- The ServerConnection instance.</span>

<span class="sd">        dcc_connections -- A list of DCCConnection instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span> <span class="o">=</span> <span class="n">IRC</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">server</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcc_connections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">add_global_handler</span><span class="p">(</span><span class="s">&quot;all_events&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatcher</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">add_global_handler</span><span class="p">(</span>
            <span class="s">&quot;dcc_disconnect&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcc_disconnect</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="s">&quot;on_&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">eventtype</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">)(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_dcc_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcc_connections</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<div class="viewcode-block" id="SimpleIRCClient.connect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.SimpleIRCClient.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">ircname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">localaddress</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">localport</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">ipv6</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect/reconnect to a server.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            server -- Server name.</span>

<span class="sd">            port -- Port number.</span>

<span class="sd">            nickname -- The nickname.</span>

<span class="sd">            password -- Password (if any).</span>

<span class="sd">            username -- The username.</span>

<span class="sd">            ircname -- The IRC name.</span>

<span class="sd">            localaddress -- Bind the connection to a specific local IP address.</span>

<span class="sd">            localport -- Bind the connection to a specific local port.</span>

<span class="sd">            ssl -- Enable support for ssl.</span>

<span class="sd">            ipv6 -- Enable support for ipv6.</span>

<span class="sd">        This function can be called to reconnect a closed connection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span>
                                <span class="n">password</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">ircname</span><span class="p">,</span>
                                <span class="n">localaddress</span><span class="p">,</span> <span class="n">localport</span><span class="p">,</span> <span class="n">ssl</span><span class="p">,</span> <span class="n">ipv6</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SimpleIRCClient.dcc_connect"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.SimpleIRCClient.dcc_connect">[docs]</a>    <span class="k">def</span> <span class="nf">dcc_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">dcctype</span><span class="o">=</span><span class="s">&quot;chat&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect to a DCC peer.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            address -- IP address of the peer.</span>

<span class="sd">            port -- Port to connect to.</span>

<span class="sd">        Returns a DCCConnection instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">dcc</span><span class="p">(</span><span class="n">dcctype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcc_connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcc</span><span class="p">)</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dcc</span>
</div>
<div class="viewcode-block" id="SimpleIRCClient.dcc_listen"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.SimpleIRCClient.dcc_listen">[docs]</a>    <span class="k">def</span> <span class="nf">dcc_listen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dcctype</span><span class="o">=</span><span class="s">&quot;chat&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Listen for connections from a DCC peer.</span>

<span class="sd">        Returns a DCCConnection instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">dcc</span><span class="p">(</span><span class="n">dcctype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcc_connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcc</span><span class="p">)</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dcc</span>
</div>
<div class="viewcode-block" id="SimpleIRCClient.start"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.SimpleIRCClient.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the IRC client.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ircobj</span><span class="o">.</span><span class="n">process_forever</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="Event"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Event">[docs]</a><span class="k">class</span> <span class="nc">Event</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class representing an IRC event.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventtype</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor of Event objects.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            eventtype -- A string describing the event.</span>

<span class="sd">            source -- The originator of the event (a nick mask or a server).</span>

<span class="sd">            target -- The target of the event (a nick or a channel).</span>

<span class="sd">            arguments -- Any event specific arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eventtype</span> <span class="o">=</span> <span class="n">eventtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="k">if</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="n">arguments</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Event.eventtype"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Event.eventtype">[docs]</a>    <span class="k">def</span> <span class="nf">eventtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the event type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eventtype</span>
</div>
<div class="viewcode-block" id="Event.source"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Event.source">[docs]</a>    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the event source.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>
</div>
<div class="viewcode-block" id="Event.target"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Event.target">[docs]</a>    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the event target.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>
</div>
<div class="viewcode-block" id="Event.arguments"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.Event.arguments">[docs]</a>    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the event arguments.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>
</div></div>
<span class="n">_LOW_LEVEL_QUOTE</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\020</span><span class="s">&quot;</span>
<span class="n">_CTCP_LEVEL_QUOTE</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\134</span><span class="s">&quot;</span>
<span class="n">_CTCP_DELIMITER</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\001</span><span class="s">&quot;</span>

<span class="n">_low_level_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;0&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\000</span><span class="s">&quot;</span><span class="p">,</span>
    <span class="s">&quot;n&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
    <span class="s">&quot;r&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">,</span>
    <span class="n">_LOW_LEVEL_QUOTE</span><span class="p">:</span> <span class="n">_LOW_LEVEL_QUOTE</span><span class="p">}</span>

<span class="n">_low_level_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">_LOW_LEVEL_QUOTE</span> <span class="o">+</span> <span class="s">&quot;(.)&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="mask_matches"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.mask_matches">[docs]</a><span class="k">def</span> <span class="nf">mask_matches</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a nick matches a mask.</span>

<span class="sd">    Returns true if the nick matches, otherwise false.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nick</span> <span class="o">=</span> <span class="n">irc_lower</span><span class="p">(</span><span class="n">nick</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">irc_lower</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\\\</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="s">&quot;.$|[](){}+&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">ch</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;?&quot;</span><span class="p">,</span> <span class="s">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;.*&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">nick</span><span class="p">)</span>
</div>
<span class="n">_special</span> <span class="o">=</span> <span class="s">&quot;-[]</span><span class="se">\\</span><span class="s">`^{}&quot;</span>
<span class="n">nick_characters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">_special</span>
<span class="n">_ircstring_translation</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="s">&quot;[]</span><span class="se">\\</span><span class="s">^&quot;</span><span class="p">,</span>
                                          <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="s">&quot;{}|~&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="irc_lower"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.irc_lower">[docs]</a><span class="k">def</span> <span class="nf">irc_lower</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a lowercased string.</span>

<span class="sd">    The definition of lowercased comes from the IRC specification (RFC</span>
<span class="sd">    1459).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">_ircstring_translation</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_ctcp_dequote</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[Internal] Dequote a message according to CTCP specifications.</span>

<span class="sd">    The function returns a list where each element can be either a</span>
<span class="sd">    string (normal message) or a tuple of one or two strings (tagged</span>
<span class="sd">    messages).  If a tuple has only one element (ie is a singleton),</span>
<span class="sd">    that element is the tag; otherwise the tuple has two elements: the</span>
<span class="sd">    tag and the data.</span>

<span class="sd">    Arguments:</span>

<span class="sd">        message -- The message to be decoded.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_low_level_replace</span><span class="p">(</span><span class="n">match_obj</span><span class="p">):</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">match_obj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># If low_level_mapping doesn&#39;t have the character as key, we</span>
        <span class="c"># should just return the character.</span>
        <span class="k">return</span> <span class="n">_low_level_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_LOW_LEVEL_QUOTE</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="c"># Yup, there was a quote.  Release the dequoter, man!</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">_low_level_regexp</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">_low_level_replace</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_CTCP_DELIMITER</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">message</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Split it into parts.  (Does any IRC client actually *use*</span>
        <span class="c"># CTCP stacking like this?)</span>
        <span class="n">chunks</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">_CTCP_DELIMITER</span><span class="p">)</span>

        <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c"># Add message if it&#39;s non-empty.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c"># Aye!  CTCP tagged data ahead!</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Hey, a lonely _CTCP_DELIMITER at the end!  This means</span>
            <span class="c"># that the last chunk, including the delimiter, is a</span>
            <span class="c"># normal message!  (This is according to the CTCP</span>
            <span class="c"># specification.)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_CTCP_DELIMITER</span> <span class="o">+</span> <span class="n">chunks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">messages</span>


<div class="viewcode-block" id="is_channel"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.is_channel">[docs]</a><span class="k">def</span> <span class="nf">is_channel</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a string is a channel name.</span>

<span class="sd">    Returns true if the argument is a channel name, otherwise false.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">string</span> <span class="ow">and</span> <span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;#&amp;+!&quot;</span>

</div>
<div class="viewcode-block" id="ip_numstr_to_quad"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ip_numstr_to_quad">[docs]</a><span class="k">def</span> <span class="nf">ip_numstr_to_quad</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert an IP number as an integer given in ASCII</span>
<span class="sd">    representation (e.g. &#39;3232235521&#39;) to an IP address string</span>
<span class="sd">    (e.g. &#39;192.168.0.1&#39;).&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">long</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
                           <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]))</span>
    <span class="k">return</span> <span class="s">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ip_quad_to_numstr"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.ip_quad_to_numstr">[docs]</a><span class="k">def</span> <span class="nf">ip_quad_to_numstr</span><span class="p">(</span><span class="n">quad</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert an IP address string (e.g. &#39;192.168.0.1&#39;) to an IP</span>
<span class="sd">    number as an integer given in ASCII representation</span>
<span class="sd">    (e.g. &#39;3232235521&#39;).&quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">long</span><span class="p">,</span> <span class="n">quad</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;L&quot;</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span>

</div>
<div class="viewcode-block" id="nm_to_n"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.nm_to_n">[docs]</a><span class="k">def</span> <span class="nf">nm_to_n</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the nick part of a nickmask.</span>

<span class="sd">    (The source of an Event is a nickmask.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="nm_to_uh"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.nm_to_uh">[docs]</a><span class="k">def</span> <span class="nf">nm_to_uh</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the userhost part of a nickmask.</span>

<span class="sd">    (The source of an Event is a nickmask.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="nm_to_h"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.nm_to_h">[docs]</a><span class="k">def</span> <span class="nf">nm_to_h</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the host part of a nickmask.</span>

<span class="sd">    (The source of an Event is a nickmask.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="nm_to_u"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.nm_to_u">[docs]</a><span class="k">def</span> <span class="nf">nm_to_u</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the user part of a nickmask.</span>

<span class="sd">    (The source of an Event is a nickmask.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="parse_nick_modes"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.parse_nick_modes">[docs]</a><span class="k">def</span> <span class="nf">parse_nick_modes</span><span class="p">(</span><span class="n">mode_string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse a nick mode string.</span>

<span class="sd">    The function returns a list of lists with three members: sign,</span>
<span class="sd">    mode and argument.  The sign is \&quot;+\&quot; or \&quot;-\&quot;.  The argument is</span>
<span class="sd">    always None.</span>

<span class="sd">    Example:</span>

<span class="sd">    &gt;&gt;&gt; irclib.parse_nick_modes(\&quot;+ab-c\&quot;)</span>
<span class="sd">    [[&#39;+&#39;, &#39;a&#39;, None], [&#39;+&#39;, &#39;b&#39;, None], [&#39;-&#39;, &#39;c&#39;, None]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_parse_modes</span><span class="p">(</span><span class="n">mode_string</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="parse_channel_modes"><a class="viewcode-back" href="../../pyhole.html#pyhole.irclib.parse_channel_modes">[docs]</a><span class="k">def</span> <span class="nf">parse_channel_modes</span><span class="p">(</span><span class="n">mode_string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse a channel mode string.</span>

<span class="sd">    The function returns a list of lists with three members: sign,</span>
<span class="sd">    mode and argument.  The sign is \&quot;+\&quot; or \&quot;-\&quot;.  The argument is</span>
<span class="sd">    None if mode isn&#39;t one of \&quot;b\&quot;, \&quot;k\&quot;, \&quot;l\&quot;, \&quot;v\&quot; or \&quot;o\&quot;.</span>

<span class="sd">    Example:</span>

<span class="sd">    &gt;&gt;&gt; irclib.parse_channel_modes(\&quot;+ab-c foo\&quot;)</span>
<span class="sd">    [[&#39;+&#39;, &#39;a&#39;, None], [&#39;+&#39;, &#39;b&#39;, &#39;foo&#39;], [&#39;-&#39;, &#39;c&#39;, None]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_parse_modes</span><span class="p">(</span><span class="n">mode_string</span><span class="p">,</span> <span class="s">&quot;bklvo&quot;</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_parse_modes</span><span class="p">(</span><span class="n">mode_string</span><span class="p">,</span> <span class="n">unary_modes</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">arg_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c"># State variable.</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">mode_string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mode_part</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">mode_part</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot;+-&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">mode_part</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="s">&quot;+-&quot;</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="n">ch</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s">&quot; &quot;</span><span class="p">:</span>
            <span class="n">collecting_arguments</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">unary_modes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">arg_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">sign</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">arg_count</span><span class="p">]])</span>
                <span class="n">arg_count</span> <span class="o">=</span> <span class="n">arg_count</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">sign</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">sign</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">modes</span>


<span class="k">def</span> <span class="nf">_ping_ponger</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[Internal]&quot;&quot;&quot;</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">pong</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">target</span><span class="p">())</span>

<span class="c"># Numeric table mostly stolen from the Perl IRC module (Net::IRC).</span>
<span class="n">numeric_events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;001&quot;</span><span class="p">:</span> <span class="s">&quot;welcome&quot;</span><span class="p">,</span>
    <span class="s">&quot;002&quot;</span><span class="p">:</span> <span class="s">&quot;yourhost&quot;</span><span class="p">,</span>
    <span class="s">&quot;003&quot;</span><span class="p">:</span> <span class="s">&quot;created&quot;</span><span class="p">,</span>
    <span class="s">&quot;004&quot;</span><span class="p">:</span> <span class="s">&quot;myinfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;005&quot;</span><span class="p">:</span> <span class="s">&quot;featurelist&quot;</span><span class="p">,</span>  <span class="c"># XXX</span>
    <span class="s">&quot;200&quot;</span><span class="p">:</span> <span class="s">&quot;tracelink&quot;</span><span class="p">,</span>
    <span class="s">&quot;201&quot;</span><span class="p">:</span> <span class="s">&quot;traceconnecting&quot;</span><span class="p">,</span>
    <span class="s">&quot;202&quot;</span><span class="p">:</span> <span class="s">&quot;tracehandshake&quot;</span><span class="p">,</span>
    <span class="s">&quot;203&quot;</span><span class="p">:</span> <span class="s">&quot;traceunknown&quot;</span><span class="p">,</span>
    <span class="s">&quot;204&quot;</span><span class="p">:</span> <span class="s">&quot;traceoperator&quot;</span><span class="p">,</span>
    <span class="s">&quot;205&quot;</span><span class="p">:</span> <span class="s">&quot;traceuser&quot;</span><span class="p">,</span>
    <span class="s">&quot;206&quot;</span><span class="p">:</span> <span class="s">&quot;traceserver&quot;</span><span class="p">,</span>
    <span class="s">&quot;207&quot;</span><span class="p">:</span> <span class="s">&quot;traceservice&quot;</span><span class="p">,</span>
    <span class="s">&quot;208&quot;</span><span class="p">:</span> <span class="s">&quot;tracenewtype&quot;</span><span class="p">,</span>
    <span class="s">&quot;209&quot;</span><span class="p">:</span> <span class="s">&quot;traceclass&quot;</span><span class="p">,</span>
    <span class="s">&quot;210&quot;</span><span class="p">:</span> <span class="s">&quot;tracereconnect&quot;</span><span class="p">,</span>
    <span class="s">&quot;211&quot;</span><span class="p">:</span> <span class="s">&quot;statslinkinfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;212&quot;</span><span class="p">:</span> <span class="s">&quot;statscommands&quot;</span><span class="p">,</span>
    <span class="s">&quot;213&quot;</span><span class="p">:</span> <span class="s">&quot;statscline&quot;</span><span class="p">,</span>
    <span class="s">&quot;214&quot;</span><span class="p">:</span> <span class="s">&quot;statsnline&quot;</span><span class="p">,</span>
    <span class="s">&quot;215&quot;</span><span class="p">:</span> <span class="s">&quot;statsiline&quot;</span><span class="p">,</span>
    <span class="s">&quot;216&quot;</span><span class="p">:</span> <span class="s">&quot;statskline&quot;</span><span class="p">,</span>
    <span class="s">&quot;217&quot;</span><span class="p">:</span> <span class="s">&quot;statsqline&quot;</span><span class="p">,</span>
    <span class="s">&quot;218&quot;</span><span class="p">:</span> <span class="s">&quot;statsyline&quot;</span><span class="p">,</span>
    <span class="s">&quot;219&quot;</span><span class="p">:</span> <span class="s">&quot;endofstats&quot;</span><span class="p">,</span>
    <span class="s">&quot;221&quot;</span><span class="p">:</span> <span class="s">&quot;umodeis&quot;</span><span class="p">,</span>
    <span class="s">&quot;231&quot;</span><span class="p">:</span> <span class="s">&quot;serviceinfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;232&quot;</span><span class="p">:</span> <span class="s">&quot;endofservices&quot;</span><span class="p">,</span>
    <span class="s">&quot;233&quot;</span><span class="p">:</span> <span class="s">&quot;service&quot;</span><span class="p">,</span>
    <span class="s">&quot;234&quot;</span><span class="p">:</span> <span class="s">&quot;servlist&quot;</span><span class="p">,</span>
    <span class="s">&quot;235&quot;</span><span class="p">:</span> <span class="s">&quot;servlistend&quot;</span><span class="p">,</span>
    <span class="s">&quot;241&quot;</span><span class="p">:</span> <span class="s">&quot;statslline&quot;</span><span class="p">,</span>
    <span class="s">&quot;242&quot;</span><span class="p">:</span> <span class="s">&quot;statsuptime&quot;</span><span class="p">,</span>
    <span class="s">&quot;243&quot;</span><span class="p">:</span> <span class="s">&quot;statsoline&quot;</span><span class="p">,</span>
    <span class="s">&quot;244&quot;</span><span class="p">:</span> <span class="s">&quot;statshline&quot;</span><span class="p">,</span>
    <span class="s">&quot;250&quot;</span><span class="p">:</span> <span class="s">&quot;luserconns&quot;</span><span class="p">,</span>
    <span class="s">&quot;251&quot;</span><span class="p">:</span> <span class="s">&quot;luserclient&quot;</span><span class="p">,</span>
    <span class="s">&quot;252&quot;</span><span class="p">:</span> <span class="s">&quot;luserop&quot;</span><span class="p">,</span>
    <span class="s">&quot;253&quot;</span><span class="p">:</span> <span class="s">&quot;luserunknown&quot;</span><span class="p">,</span>
    <span class="s">&quot;254&quot;</span><span class="p">:</span> <span class="s">&quot;luserchannels&quot;</span><span class="p">,</span>
    <span class="s">&quot;255&quot;</span><span class="p">:</span> <span class="s">&quot;luserme&quot;</span><span class="p">,</span>
    <span class="s">&quot;256&quot;</span><span class="p">:</span> <span class="s">&quot;adminme&quot;</span><span class="p">,</span>
    <span class="s">&quot;257&quot;</span><span class="p">:</span> <span class="s">&quot;adminloc1&quot;</span><span class="p">,</span>
    <span class="s">&quot;258&quot;</span><span class="p">:</span> <span class="s">&quot;adminloc2&quot;</span><span class="p">,</span>
    <span class="s">&quot;259&quot;</span><span class="p">:</span> <span class="s">&quot;adminemail&quot;</span><span class="p">,</span>
    <span class="s">&quot;261&quot;</span><span class="p">:</span> <span class="s">&quot;tracelog&quot;</span><span class="p">,</span>
    <span class="s">&quot;262&quot;</span><span class="p">:</span> <span class="s">&quot;endoftrace&quot;</span><span class="p">,</span>
    <span class="s">&quot;263&quot;</span><span class="p">:</span> <span class="s">&quot;tryagain&quot;</span><span class="p">,</span>
    <span class="s">&quot;265&quot;</span><span class="p">:</span> <span class="s">&quot;n_local&quot;</span><span class="p">,</span>
    <span class="s">&quot;266&quot;</span><span class="p">:</span> <span class="s">&quot;n_global&quot;</span><span class="p">,</span>
    <span class="s">&quot;300&quot;</span><span class="p">:</span> <span class="s">&quot;none&quot;</span><span class="p">,</span>
    <span class="s">&quot;301&quot;</span><span class="p">:</span> <span class="s">&quot;away&quot;</span><span class="p">,</span>
    <span class="s">&quot;302&quot;</span><span class="p">:</span> <span class="s">&quot;userhost&quot;</span><span class="p">,</span>
    <span class="s">&quot;303&quot;</span><span class="p">:</span> <span class="s">&quot;ison&quot;</span><span class="p">,</span>
    <span class="s">&quot;305&quot;</span><span class="p">:</span> <span class="s">&quot;unaway&quot;</span><span class="p">,</span>
    <span class="s">&quot;306&quot;</span><span class="p">:</span> <span class="s">&quot;nowaway&quot;</span><span class="p">,</span>
    <span class="s">&quot;311&quot;</span><span class="p">:</span> <span class="s">&quot;whoisuser&quot;</span><span class="p">,</span>
    <span class="s">&quot;312&quot;</span><span class="p">:</span> <span class="s">&quot;whoisserver&quot;</span><span class="p">,</span>
    <span class="s">&quot;313&quot;</span><span class="p">:</span> <span class="s">&quot;whoisoperator&quot;</span><span class="p">,</span>
    <span class="s">&quot;314&quot;</span><span class="p">:</span> <span class="s">&quot;whowasuser&quot;</span><span class="p">,</span>
    <span class="s">&quot;315&quot;</span><span class="p">:</span> <span class="s">&quot;endofwho&quot;</span><span class="p">,</span>
    <span class="s">&quot;316&quot;</span><span class="p">:</span> <span class="s">&quot;whoischanop&quot;</span><span class="p">,</span>
    <span class="s">&quot;317&quot;</span><span class="p">:</span> <span class="s">&quot;whoisidle&quot;</span><span class="p">,</span>
    <span class="s">&quot;318&quot;</span><span class="p">:</span> <span class="s">&quot;endofwhois&quot;</span><span class="p">,</span>
    <span class="s">&quot;319&quot;</span><span class="p">:</span> <span class="s">&quot;whoischannels&quot;</span><span class="p">,</span>
    <span class="s">&quot;321&quot;</span><span class="p">:</span> <span class="s">&quot;liststart&quot;</span><span class="p">,</span>
    <span class="s">&quot;322&quot;</span><span class="p">:</span> <span class="s">&quot;list&quot;</span><span class="p">,</span>
    <span class="s">&quot;323&quot;</span><span class="p">:</span> <span class="s">&quot;listend&quot;</span><span class="p">,</span>
    <span class="s">&quot;324&quot;</span><span class="p">:</span> <span class="s">&quot;channelmodeis&quot;</span><span class="p">,</span>
    <span class="s">&quot;329&quot;</span><span class="p">:</span> <span class="s">&quot;channelcreate&quot;</span><span class="p">,</span>
    <span class="s">&quot;331&quot;</span><span class="p">:</span> <span class="s">&quot;notopic&quot;</span><span class="p">,</span>
    <span class="s">&quot;332&quot;</span><span class="p">:</span> <span class="s">&quot;currenttopic&quot;</span><span class="p">,</span>
    <span class="s">&quot;333&quot;</span><span class="p">:</span> <span class="s">&quot;topicinfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;341&quot;</span><span class="p">:</span> <span class="s">&quot;inviting&quot;</span><span class="p">,</span>
    <span class="s">&quot;342&quot;</span><span class="p">:</span> <span class="s">&quot;summoning&quot;</span><span class="p">,</span>
    <span class="s">&quot;346&quot;</span><span class="p">:</span> <span class="s">&quot;invitelist&quot;</span><span class="p">,</span>
    <span class="s">&quot;347&quot;</span><span class="p">:</span> <span class="s">&quot;endofinvitelist&quot;</span><span class="p">,</span>
    <span class="s">&quot;348&quot;</span><span class="p">:</span> <span class="s">&quot;exceptlist&quot;</span><span class="p">,</span>
    <span class="s">&quot;349&quot;</span><span class="p">:</span> <span class="s">&quot;endofexceptlist&quot;</span><span class="p">,</span>
    <span class="s">&quot;351&quot;</span><span class="p">:</span> <span class="s">&quot;version&quot;</span><span class="p">,</span>
    <span class="s">&quot;352&quot;</span><span class="p">:</span> <span class="s">&quot;whoreply&quot;</span><span class="p">,</span>
    <span class="s">&quot;353&quot;</span><span class="p">:</span> <span class="s">&quot;namreply&quot;</span><span class="p">,</span>
    <span class="s">&quot;361&quot;</span><span class="p">:</span> <span class="s">&quot;killdone&quot;</span><span class="p">,</span>
    <span class="s">&quot;362&quot;</span><span class="p">:</span> <span class="s">&quot;closing&quot;</span><span class="p">,</span>
    <span class="s">&quot;363&quot;</span><span class="p">:</span> <span class="s">&quot;closeend&quot;</span><span class="p">,</span>
    <span class="s">&quot;364&quot;</span><span class="p">:</span> <span class="s">&quot;links&quot;</span><span class="p">,</span>
    <span class="s">&quot;365&quot;</span><span class="p">:</span> <span class="s">&quot;endoflinks&quot;</span><span class="p">,</span>
    <span class="s">&quot;366&quot;</span><span class="p">:</span> <span class="s">&quot;endofnames&quot;</span><span class="p">,</span>
    <span class="s">&quot;367&quot;</span><span class="p">:</span> <span class="s">&quot;banlist&quot;</span><span class="p">,</span>
    <span class="s">&quot;368&quot;</span><span class="p">:</span> <span class="s">&quot;endofbanlist&quot;</span><span class="p">,</span>
    <span class="s">&quot;369&quot;</span><span class="p">:</span> <span class="s">&quot;endofwhowas&quot;</span><span class="p">,</span>
    <span class="s">&quot;371&quot;</span><span class="p">:</span> <span class="s">&quot;info&quot;</span><span class="p">,</span>
    <span class="s">&quot;372&quot;</span><span class="p">:</span> <span class="s">&quot;motd&quot;</span><span class="p">,</span>
    <span class="s">&quot;373&quot;</span><span class="p">:</span> <span class="s">&quot;infostart&quot;</span><span class="p">,</span>
    <span class="s">&quot;374&quot;</span><span class="p">:</span> <span class="s">&quot;endofinfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;375&quot;</span><span class="p">:</span> <span class="s">&quot;motdstart&quot;</span><span class="p">,</span>
    <span class="s">&quot;376&quot;</span><span class="p">:</span> <span class="s">&quot;endofmotd&quot;</span><span class="p">,</span>
    <span class="s">&quot;377&quot;</span><span class="p">:</span> <span class="s">&quot;motd2&quot;</span><span class="p">,</span>        <span class="c"># 1997-10-16 -- tkil</span>
    <span class="s">&quot;381&quot;</span><span class="p">:</span> <span class="s">&quot;youreoper&quot;</span><span class="p">,</span>
    <span class="s">&quot;382&quot;</span><span class="p">:</span> <span class="s">&quot;rehashing&quot;</span><span class="p">,</span>
    <span class="s">&quot;384&quot;</span><span class="p">:</span> <span class="s">&quot;myportis&quot;</span><span class="p">,</span>
    <span class="s">&quot;391&quot;</span><span class="p">:</span> <span class="s">&quot;time&quot;</span><span class="p">,</span>
    <span class="s">&quot;392&quot;</span><span class="p">:</span> <span class="s">&quot;usersstart&quot;</span><span class="p">,</span>
    <span class="s">&quot;393&quot;</span><span class="p">:</span> <span class="s">&quot;users&quot;</span><span class="p">,</span>
    <span class="s">&quot;394&quot;</span><span class="p">:</span> <span class="s">&quot;endofusers&quot;</span><span class="p">,</span>
    <span class="s">&quot;395&quot;</span><span class="p">:</span> <span class="s">&quot;nousers&quot;</span><span class="p">,</span>
    <span class="s">&quot;401&quot;</span><span class="p">:</span> <span class="s">&quot;nosuchnick&quot;</span><span class="p">,</span>
    <span class="s">&quot;402&quot;</span><span class="p">:</span> <span class="s">&quot;nosuchserver&quot;</span><span class="p">,</span>
    <span class="s">&quot;403&quot;</span><span class="p">:</span> <span class="s">&quot;nosuchchannel&quot;</span><span class="p">,</span>
    <span class="s">&quot;404&quot;</span><span class="p">:</span> <span class="s">&quot;cannotsendtochan&quot;</span><span class="p">,</span>
    <span class="s">&quot;405&quot;</span><span class="p">:</span> <span class="s">&quot;toomanychannels&quot;</span><span class="p">,</span>
    <span class="s">&quot;406&quot;</span><span class="p">:</span> <span class="s">&quot;wasnosuchnick&quot;</span><span class="p">,</span>
    <span class="s">&quot;407&quot;</span><span class="p">:</span> <span class="s">&quot;toomanytargets&quot;</span><span class="p">,</span>
    <span class="s">&quot;409&quot;</span><span class="p">:</span> <span class="s">&quot;noorigin&quot;</span><span class="p">,</span>
    <span class="s">&quot;411&quot;</span><span class="p">:</span> <span class="s">&quot;norecipient&quot;</span><span class="p">,</span>
    <span class="s">&quot;412&quot;</span><span class="p">:</span> <span class="s">&quot;notexttosend&quot;</span><span class="p">,</span>
    <span class="s">&quot;413&quot;</span><span class="p">:</span> <span class="s">&quot;notoplevel&quot;</span><span class="p">,</span>
    <span class="s">&quot;414&quot;</span><span class="p">:</span> <span class="s">&quot;wildtoplevel&quot;</span><span class="p">,</span>
    <span class="s">&quot;421&quot;</span><span class="p">:</span> <span class="s">&quot;unknowncommand&quot;</span><span class="p">,</span>
    <span class="s">&quot;422&quot;</span><span class="p">:</span> <span class="s">&quot;nomotd&quot;</span><span class="p">,</span>
    <span class="s">&quot;423&quot;</span><span class="p">:</span> <span class="s">&quot;noadmininfo&quot;</span><span class="p">,</span>
    <span class="s">&quot;424&quot;</span><span class="p">:</span> <span class="s">&quot;fileerror&quot;</span><span class="p">,</span>
    <span class="s">&quot;431&quot;</span><span class="p">:</span> <span class="s">&quot;nonicknamegiven&quot;</span><span class="p">,</span>
    <span class="s">&quot;432&quot;</span><span class="p">:</span> <span class="s">&quot;erroneusnickname&quot;</span><span class="p">,</span>  <span class="c"># Thiss iz how its speld in thee RFC.</span>
    <span class="s">&quot;433&quot;</span><span class="p">:</span> <span class="s">&quot;nicknameinuse&quot;</span><span class="p">,</span>
    <span class="s">&quot;436&quot;</span><span class="p">:</span> <span class="s">&quot;nickcollision&quot;</span><span class="p">,</span>
    <span class="s">&quot;437&quot;</span><span class="p">:</span> <span class="s">&quot;unavailresource&quot;</span><span class="p">,</span>  <span class="c"># &quot;Nick temporally unavailable&quot;</span>
    <span class="s">&quot;441&quot;</span><span class="p">:</span> <span class="s">&quot;usernotinchannel&quot;</span><span class="p">,</span>
    <span class="s">&quot;442&quot;</span><span class="p">:</span> <span class="s">&quot;notonchannel&quot;</span><span class="p">,</span>
    <span class="s">&quot;443&quot;</span><span class="p">:</span> <span class="s">&quot;useronchannel&quot;</span><span class="p">,</span>
    <span class="s">&quot;444&quot;</span><span class="p">:</span> <span class="s">&quot;nologin&quot;</span><span class="p">,</span>
    <span class="s">&quot;445&quot;</span><span class="p">:</span> <span class="s">&quot;summondisabled&quot;</span><span class="p">,</span>
    <span class="s">&quot;446&quot;</span><span class="p">:</span> <span class="s">&quot;usersdisabled&quot;</span><span class="p">,</span>
    <span class="s">&quot;451&quot;</span><span class="p">:</span> <span class="s">&quot;notregistered&quot;</span><span class="p">,</span>
    <span class="s">&quot;461&quot;</span><span class="p">:</span> <span class="s">&quot;needmoreparams&quot;</span><span class="p">,</span>
    <span class="s">&quot;462&quot;</span><span class="p">:</span> <span class="s">&quot;alreadyregistered&quot;</span><span class="p">,</span>
    <span class="s">&quot;463&quot;</span><span class="p">:</span> <span class="s">&quot;nopermforhost&quot;</span><span class="p">,</span>
    <span class="s">&quot;464&quot;</span><span class="p">:</span> <span class="s">&quot;passwdmismatch&quot;</span><span class="p">,</span>
    <span class="s">&quot;465&quot;</span><span class="p">:</span> <span class="s">&quot;yourebannedcreep&quot;</span><span class="p">,</span>  <span class="c"># I love this one...</span>
    <span class="s">&quot;466&quot;</span><span class="p">:</span> <span class="s">&quot;youwillbebanned&quot;</span><span class="p">,</span>
    <span class="s">&quot;467&quot;</span><span class="p">:</span> <span class="s">&quot;keyset&quot;</span><span class="p">,</span>
    <span class="s">&quot;471&quot;</span><span class="p">:</span> <span class="s">&quot;channelisfull&quot;</span><span class="p">,</span>
    <span class="s">&quot;472&quot;</span><span class="p">:</span> <span class="s">&quot;unknownmode&quot;</span><span class="p">,</span>
    <span class="s">&quot;473&quot;</span><span class="p">:</span> <span class="s">&quot;inviteonlychan&quot;</span><span class="p">,</span>
    <span class="s">&quot;474&quot;</span><span class="p">:</span> <span class="s">&quot;bannedfromchan&quot;</span><span class="p">,</span>
    <span class="s">&quot;475&quot;</span><span class="p">:</span> <span class="s">&quot;badchannelkey&quot;</span><span class="p">,</span>
    <span class="s">&quot;476&quot;</span><span class="p">:</span> <span class="s">&quot;badchanmask&quot;</span><span class="p">,</span>
    <span class="s">&quot;477&quot;</span><span class="p">:</span> <span class="s">&quot;nochanmodes&quot;</span><span class="p">,</span>  <span class="c"># &quot;Channel doesn&#39;t support modes&quot;</span>
    <span class="s">&quot;478&quot;</span><span class="p">:</span> <span class="s">&quot;banlistfull&quot;</span><span class="p">,</span>
    <span class="s">&quot;481&quot;</span><span class="p">:</span> <span class="s">&quot;noprivileges&quot;</span><span class="p">,</span>
    <span class="s">&quot;482&quot;</span><span class="p">:</span> <span class="s">&quot;chanoprivsneeded&quot;</span><span class="p">,</span>
    <span class="s">&quot;483&quot;</span><span class="p">:</span> <span class="s">&quot;cantkillserver&quot;</span><span class="p">,</span>
    <span class="s">&quot;484&quot;</span><span class="p">:</span> <span class="s">&quot;restricted&quot;</span><span class="p">,</span>   <span class="c"># Connection is restricted</span>
    <span class="s">&quot;485&quot;</span><span class="p">:</span> <span class="s">&quot;uniqopprivsneeded&quot;</span><span class="p">,</span>
    <span class="s">&quot;491&quot;</span><span class="p">:</span> <span class="s">&quot;nooperhost&quot;</span><span class="p">,</span>
    <span class="s">&quot;492&quot;</span><span class="p">:</span> <span class="s">&quot;noservicehost&quot;</span><span class="p">,</span>
    <span class="s">&quot;501&quot;</span><span class="p">:</span> <span class="s">&quot;umodeunknownflag&quot;</span><span class="p">,</span>
    <span class="s">&quot;502&quot;</span><span class="p">:</span> <span class="s">&quot;usersdontmatch&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">generated_events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c"># Generated events</span>
    <span class="s">&quot;dcc_connect&quot;</span><span class="p">,</span>
    <span class="s">&quot;dcc_disconnect&quot;</span><span class="p">,</span>
    <span class="s">&quot;dccmsg&quot;</span><span class="p">,</span>
    <span class="s">&quot;disconnect&quot;</span><span class="p">,</span>
    <span class="s">&quot;ctcp&quot;</span><span class="p">,</span>
    <span class="s">&quot;ctcpreply&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">protocol_events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c"># IRC protocol events</span>
    <span class="s">&quot;error&quot;</span><span class="p">,</span>
    <span class="s">&quot;join&quot;</span><span class="p">,</span>
    <span class="s">&quot;kick&quot;</span><span class="p">,</span>
    <span class="s">&quot;mode&quot;</span><span class="p">,</span>
    <span class="s">&quot;part&quot;</span><span class="p">,</span>
    <span class="s">&quot;ping&quot;</span><span class="p">,</span>
    <span class="s">&quot;privmsg&quot;</span><span class="p">,</span>
    <span class="s">&quot;privnotice&quot;</span><span class="p">,</span>
    <span class="s">&quot;pubmsg&quot;</span><span class="p">,</span>
    <span class="s">&quot;pubnotice&quot;</span><span class="p">,</span>
    <span class="s">&quot;quit&quot;</span><span class="p">,</span>
    <span class="s">&quot;invite&quot;</span><span class="p">,</span>
    <span class="s">&quot;pong&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">all_events</span> <span class="o">=</span> <span class="n">generated_events</span> <span class="o">+</span> <span class="n">protocol_events</span> <span class="o">+</span> <span class="n">numeric_events</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">pyhole v0.5.4-2f4ef documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Josh Kearney.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>